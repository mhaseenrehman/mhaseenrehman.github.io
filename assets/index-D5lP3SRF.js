import*as r from"https://unpkg.com/three/build/three.module.js";import{EffectComposer as V}from"https://unpkg.com/three/examples/jsm/postprocessing/EffectComposer.js";import{OutputPass as j}from"https://unpkg.com/three/examples/jsm/postprocessing/OutputPass.js";import{RenderPass as G}from"https://unpkg.com/three/examples/jsm/postprocessing/RenderPass.js";import{GLTFLoader as q}from"https://unpkg.com/three/examples/jsm/loaders/GLTFLoader.js";import{CSS2DRenderer as A,CSS2DObject as B}from"https://unpkg.com/three/examples/jsm/renderers/CSS2DRenderer.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))a(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();let D=fetch("./shaders/solarVertexShader.glsl").text(),N=fetch("./shaders/solarFragmentShader.glsl").text();var m,s,f,w,x,S,P,g,u,b,O=new r.Quaternion,z=new r.Quaternion,h,E,R,W=[],L=[];function F(){const e=new r.TextureLoader,t=e.load("assets/solarTexture.png");t.colorSpace=r.SRGBColorSpace,t.wrapS=t.wrapT=r.RepeatWrapping;const n=e.load("assets/noiseTexture.png");n.wrapS=n.wrapT=r.RepeatWrapping,P={time:{value:1},fogDensity:{value:0},fogColour:{value:new r.Vector3(0,0,0)},uvScale:{value:new r.Vector2(3,1)},texture1:{value:n},texture2:{value:t}};const a=new r.SphereGeometry(1),o=new r.ShaderMaterial({uniforms:P,vertexShader:D,fragmentShader:N});return g=new r.Mesh(a,o),g.rotation.x=.3,g}function Q(){const e=new r.PointLight(16777215,100);return e.power=1e5,e.position.set(0,0,0),e}async function k(e){const t="./models/",n=new q;var a=[],o=-3;for(let i=1;i<12;i++){const l=t+"Planet-"+i.toString()+".glb";let d=await n.loadAsync(l);const p=new r.Object3D;p.add(d.scene),p.scale.set(.3,.3,.3),p.position.set(0,0,o),a.push(p),e.add(p),o-=2}return Promise.all(a)}function K(){let e=[],t=[],n=20,a=15,o=.55,i=.45;for(let p=0;p<11;p++){var l=Math.random()*(o-i)+i,d=Math.floor(Math.random()*16777215);let y=new r.EllipseCurve(0,0,n,a),v=new r.Line(new r.BufferGeometry().setFromPoints(y.getSpacedPoints(100)),new r.LineBasicMaterial({color:d}));v.rotation.x=-Math.PI*l,e.push(y),t.push(v),a+=10,n+=10}return{planetaryCurves:e,planetaryLines:t}}function U(){for(let e=0;e<11;e++)if(h[e]){let n=Math.random();W[e]=n}}function X(){let e=[],t=[];for(let n=0;n<11;n++)h[n];return{cameraPositions:e,cameraRotations:t}}function Y(){const e=document.getElementsByClassName("information-panel");for(let t=0;t<4;t++){let n=new B(e[t]);L.push(n)}}async function _(){const e=document.getElementById("container");m=new r.Scene;const t=window.innerWidth,n=window.innerHeight,a=t/n;s=new r.PerspectiveCamera(75,a,.1,1e3),s.position.set(0,0,5),S=new r.Clock;const o=new r.CubeTextureLoader().setPath("./assets/").load(["right.png","left.png","top.png","bottom.png","front.png","back.png"]),i=F();i.position.z=0;const l=Q(),d=await k(m);let p=.005,y=.001;for(let c=0;c<11;c++){let H=d[c];H.celestialWeight=Math.random()*(p-y)+y}const{planetaryCurves:v,planetaryLines:C}=K();h=d,E=v,R=C,X();var M=-3;for(let c=0;c<d.length;c++)d[c].position.z=M,M-=2;U(),m.background=o,m.add(i),m.add(l);for(let c=0;c<11;c++)m.add(C[c]);f=new r.WebGLRenderer,f.setPixelRatio(window.devicePixelRatio),f.setSize(window.innerWidth,window.innerHeight),f.autoClear=!1,e.appendChild(f.domElement),w=new A,w.setSize(window.innerWidth,window.innerHeight),w.domElement.style.position="absolute",w.domElement.style.top="0px",e.appendChild(w.domElement),Y();const T=new G(m,s),I=new j;x=new V(f),x.addPass(T),x.addPass(I),window.addEventListener("resize",J),addEventListener("wheel",c=>Z()),f.setAnimationLoop($),u=-1,b=!1}function J(){s.aspect=window.innerWidth/window.innerHeight,s.updateProjectionMatrix(),f.setSize(window.innerWidth,window.innerHeight),x.setSize(window.innerWidth,window.innerHeight)}function Z(){u=(u+1)%11;let e=(u-1)%11;L[e].element.style.display="none"}function $(){const e=5*S.getDelta();P.time.value+=.2*e,g.rotation.x+=.05*e,g.rotation.y+=.0125*e,ee(),te(),ne(),oe(),f.clear(),x.render(.01),w.render(m,s)}function ee(){for(let e=0;e<11;e++){let t=E[e],n=h[e],a=R[e];if(n&&t&&a){let o=W[e],i=n.celestialWeight,l=new r.Vector3,d=(o+S.getElapsedTime()*i)%1;t.getPointAt(d,l),n.position.copy(l),n.position.applyMatrix4(a.matrixWorld)}}}function te(){if(u>=0){b=!0;let e=h[u],t=new r.Vector3,n=new r.Vector3;n.copy(e.position),t.subVectors(g.position,e.position).normalize(),s.position.lerp(n.add(t.multiplyScalar(2)),.01)}}function ne(){if(b){let e=h[u];O=s.quaternion.clone(),s.lookAt(e.position),z=s.quaternion.clone(),s.quaternion.copy(O),s.quaternion.slerp(z,.1)}}function oe(){if(u>=0&&re(s.position,h[u].position)){let t=L[u];t.element.style.display="inline"}}function re(e,t){let n=5;return Math.abs(e.x-t.x)<n&&Math.abs(e.y-t.y)<n&&Math.abs(e.z-t.z)<n}_();
